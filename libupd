#!/bin/bash

# Helper functions that can be used by scriptlets

REQUIRE=()

require() {
  for prog in "$@"
  do
    for i in "${!REQUIRE[@]}"
    do
      if [ "${REQUIRE[$i]}" == "$prog" ]
      then
        return 0
      fi
    done
    if ! which "$prog" &>/dev/null
    then
      echo "'$prog' required but not present" >&2
      exit 1
    fi
    echo "'$prog' is present"
    REQUIRE+=( "${prog}" )
  done
}

check_sudo() {
  if [ "$CHECK_SUDO" = "true"  ]
  then
    return 0
  fi
  require sudo
  if ! sudo -n true &>/dev/null
  then
    echo "'sudo' not configured to run passwordless!" >&2
    exit 1
  fi
  echo "'sudo' can run passwordless"
  export CHECK_SUDO=true
}


